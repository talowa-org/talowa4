// Document Preview Widget - Display document attachments with preview\n// Part of Task 6: Implement PostWidget for individual posts\n\nimport 'package:flutter/material.dart';\nimport 'package:path/path.dart' as path;\nimport '../../core/theme/app_theme.dart';\n\nclass DocumentPreviewWidget extends StatelessWidget {\n  final String documentUrl;\n  final String? fileName;\n  final int? fileSize;\n  final VoidCallback? onTap;\n  final VoidCallback? onDownload;\n  final bool showDownloadButton;\n  final EdgeInsets? margin;\n\n  const DocumentPreviewWidget({\n    super.key,\n    required this.documentUrl,\n    this.fileName,\n    this.fileSize,\n    this.onTap,\n    this.onDownload,\n    this.showDownloadButton = true,\n    this.margin,\n  });\n\n  @override\n  Widget build(BuildContext context) {\n    final docInfo = _getDocumentInfo();\n    \n    return Container(\n      margin: margin ?? const EdgeInsets.only(bottom: 8),\n      decoration: BoxDecoration(\n        color: Colors.grey[50],\n        borderRadius: BorderRadius.circular(12),\n        border: Border.all(\n          color: Colors.grey[300]!,\n          width: 1,\n        ),\n      ),\n      child: Material(\n        color: Colors.transparent,\n        child: InkWell(\n          onTap: onTap,\n          borderRadius: BorderRadius.circular(12),\n          child: Padding(\n            padding: const EdgeInsets.all(12),\n            child: Row(\n              children: [\n                // Document icon\n                Container(\n                  width: 48,\n                  height: 48,\n                  decoration: BoxDecoration(\n                    color: docInfo.color.withOpacity(0.1),\n                    borderRadius: BorderRadius.circular(8),\n                  ),\n                  child: Icon(\n                    docInfo.icon,\n                    color: docInfo.color,\n                    size: 24,\n                  ),\n                ),\n                \n                const SizedBox(width: 12),\n                \n                // Document info\n                Expanded(\n                  child: Column(\n                    crossAxisAlignment: CrossAxisAlignment.start,\n                    children: [\n                      Text(\n                        docInfo.displayName,\n                        style: Theme.of(context).textTheme.titleSmall?.copyWith(\n                          fontWeight: FontWeight.w600,\n                        ),\n                        maxLines: 1,\n                        overflow: TextOverflow.ellipsis,\n                      ),\n                      \n                      const SizedBox(height: 2),\n                      \n                      Row(\n                        children: [\n                          Text(\n                            docInfo.extension.toUpperCase(),\n                            style: Theme.of(context).textTheme.bodySmall?.copyWith(\n                              color: docInfo.color,\n                              fontWeight: FontWeight.w600,\n                            ),\n                          ),\n                          \n                          if (fileSize != null) ...[\n                            Text(\n                              ' â€¢ ${_formatFileSize(fileSize!)}',\n                              style: Theme.of(context).textTheme.bodySmall?.copyWith(\n                                color: Colors.grey[600],\n                              ),\n                            ),\n                          ],\n                        ],\n                      ),\n                    ],\n                  ),\n                ),\n                \n                // Download button\n                if (showDownloadButton)\n                  IconButton(\n                    onPressed: onDownload ?? _handleDownload,\n                    icon: Icon(\n                      Icons.download,\n                      color: Colors.grey[600],\n                    ),\n                    tooltip: 'Download',\n                  ),\n              ],\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n\n  _DocumentInfo _getDocumentInfo() {\n    final extension = path.extension(documentUrl).toLowerCase();\n    final name = fileName ?? path.basenameWithoutExtension(documentUrl);\n    \n    switch (extension) {\n      case '.pdf':\n        return _DocumentInfo(\n          displayName: name,\n          extension: 'pdf',\n          icon: Icons.picture_as_pdf,\n          color: Colors.red,\n        );\n      \n      case '.doc':\n      case '.docx':\n        return _DocumentInfo(\n          displayName: name,\n          extension: extension.substring(1),\n          icon: Icons.description,\n          color: Colors.blue,\n        );\n      \n      case '.xls':\n      case '.xlsx':\n        return _DocumentInfo(\n          displayName: name,\n          extension: extension.substring(1),\n          icon: Icons.table_chart,\n          color: Colors.green,\n        );\n      \n      case '.ppt':\n      case '.pptx':\n        return _DocumentInfo(\n          displayName: name,\n          extension: extension.substring(1),\n          icon: Icons.slideshow,\n          color: Colors.orange,\n        );\n      \n      case '.txt':\n        return _DocumentInfo(\n          displayName: name,\n          extension: 'txt',\n          icon: Icons.text_snippet,\n          color: Colors.grey,\n        );\n      \n      case '.jpg':\n      case '.jpeg':\n      case '.png':\n      case '.gif':\n        return _DocumentInfo(\n          displayName: name,\n          extension: extension.substring(1),\n          icon: Icons.image,\n          color: Colors.purple,\n        );\n      \n      case '.mp4':\n      case '.avi':\n      case '.mov':\n        return _DocumentInfo(\n          displayName: name,\n          extension: extension.substring(1),\n          icon: Icons.video_file,\n          color: Colors.indigo,\n        );\n      \n      case '.mp3':\n      case '.wav':\n      case '.m4a':\n        return _DocumentInfo(\n          displayName: name,\n          extension: extension.substring(1),\n          icon: Icons.audio_file,\n          color: Colors.teal,\n        );\n      \n      case '.zip':\n      case '.rar':\n      case '.7z':\n        return _DocumentInfo(\n          displayName: name,\n          extension: extension.substring(1),\n          icon: Icons.folder_zip,\n          color: Colors.brown,\n        );\n      \n      default:\n        return _DocumentInfo(\n          displayName: name,\n          extension: extension.isNotEmpty ? extension.substring(1) : 'file',\n          icon: Icons.insert_drive_file,\n          color: Colors.grey,\n        );\n    }\n  }\n\n  String _formatFileSize(int bytes) {\n    if (bytes < 1024) {\n      return '${bytes}B';\n    } else if (bytes < 1024 * 1024) {\n      return '${(bytes / 1024).toStringAsFixed(1)}KB';\n    } else if (bytes < 1024 * 1024 * 1024) {\n      return '${(bytes / (1024 * 1024)).toStringAsFixed(1)}MB';\n    } else {\n      return '${(bytes / (1024 * 1024 * 1024)).toStringAsFixed(1)}GB';\n    }\n  }\n\n  void _handleDownload() {\n    // TODO: Implement actual download functionality\n    debugPrint('Download document: $documentUrl');\n  }\n}\n\nclass _DocumentInfo {\n  final String displayName;\n  final String extension;\n  final IconData icon;\n  final Color color;\n\n  const _DocumentInfo({\n    required this.displayName,\n    required this.extension,\n    required this.icon,\n    required this.color,\n  });\n}\n\n// Document list widget for multiple documents\nclass DocumentListWidget extends StatelessWidget {\n  final List<String> documentUrls;\n  final List<String>? fileNames;\n  final List<int>? fileSizes;\n  final Function(int)? onDocumentTap;\n  final Function(int)? onDocumentDownload;\n  final bool showDownloadButtons;\n  final EdgeInsets? padding;\n\n  const DocumentListWidget({\n    super.key,\n    required this.documentUrls,\n    this.fileNames,\n    this.fileSizes,\n    this.onDocumentTap,\n    this.onDocumentDownload,\n    this.showDownloadButtons = true,\n    this.padding,\n  });\n\n  @override\n  Widget build(BuildContext context) {\n    if (documentUrls.isEmpty) return const SizedBox.shrink();\n    \n    return Padding(\n      padding: padding ?? EdgeInsets.zero,\n      child: Column(\n        crossAxisAlignment: CrossAxisAlignment.start,\n        children: [\n          Text(\n            'Documents (${documentUrls.length})',\n            style: Theme.of(context).textTheme.titleSmall?.copyWith(\n              fontWeight: FontWeight.w600,\n            ),\n          ),\n          \n          const SizedBox(height: 8),\n          \n          ...documentUrls.asMap().entries.map((entry) {\n            final index = entry.key;\n            final url = entry.value;\n            \n            return DocumentPreviewWidget(\n              documentUrl: url,\n              fileName: fileNames != null && index < fileNames!.length\n                  ? fileNames![index]\n                  : null,\n              fileSize: fileSizes != null && index < fileSizes!.length\n                  ? fileSizes![index]\n                  : null,\n              onTap: () => onDocumentTap?.call(index),\n              onDownload: () => onDocumentDownload?.call(index),\n              showDownloadButton: showDownloadButtons,\n            );\n          }),\n        ],\n      ),\n    );\n  }\n}\n\n// Compact document preview for small spaces\nclass CompactDocumentPreviewWidget extends StatelessWidget {\n  final String documentUrl;\n  final String? fileName;\n  final VoidCallback? onTap;\n  final double size;\n\n  const CompactDocumentPreviewWidget({\n    super.key,\n    required this.documentUrl,\n    this.fileName,\n    this.onTap,\n    this.size = 40,\n  });\n\n  @override\n  Widget build(BuildContext context) {\n    final extension = path.extension(documentUrl).toLowerCase();\n    final docInfo = _getCompactDocumentInfo(extension);\n    \n    return GestureDetector(\n      onTap: onTap,\n      child: Container(\n        width: size,\n        height: size,\n        decoration: BoxDecoration(\n          color: docInfo.color.withOpacity(0.1),\n          borderRadius: BorderRadius.circular(8),\n          border: Border.all(\n            color: docInfo.color.withOpacity(0.3),\n            width: 1,\n          ),\n        ),\n        child: Icon(\n          docInfo.icon,\n          color: docInfo.color,\n          size: size * 0.5,\n        ),\n      ),\n    );\n  }\n\n  _DocumentInfo _getCompactDocumentInfo(String extension) {\n    switch (extension) {\n      case '.pdf':\n        return _DocumentInfo(\n          displayName: '',\n          extension: 'pdf',\n          icon: Icons.picture_as_pdf,\n          color: Colors.red,\n        );\n      case '.doc':\n      case '.docx':\n        return _DocumentInfo(\n          displayName: '',\n          extension: 'doc',\n          icon: Icons.description,\n          color: Colors.blue,\n        );\n      default:\n        return _DocumentInfo(\n          displayName: '',\n          extension: 'file',\n          icon: Icons.insert_drive_file,\n          color: Colors.grey,\n        );\n    }\n  }\n}"